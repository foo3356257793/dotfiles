#!/usr/bin/python3

import os

def make_file(fname):

    html_file = fname[0:-2] + "html"

    os.system(f"pandoc --standalone -c pandoc.css -f markdown -t html -o {html_file} {fname}")

def fill_email(template_file, number, name, email):

    out_file = f"masked_singer_{email}.md"

    with open(template_file, "r") as f:
        lines = f.readlines()

    with open(out_file, "w") as f:
        for line in lines:
            if "<name>" in line:
                fields = line.split("<name>")
                line = f"{name}".join(fields)
            if "<turn>" in line:
                fields = line.split("<turn>")
                line = f"\#{number}".join(fields)
            f.write(line)

    make_file(out_file)

if __name__ == "__main__":


    template_file = "email_20210214.md"

    singers = [ ["Taylor", "taylorjarvis05@gmail.com"],
               ["Kennedy", "bradshaw.bk4@gmail.com"],
               ["Kasey", "kasey.jarvis@gmail.com"],
               ["Audrey", "kimpeterson08@gmail.com"],
               ["Andrew", "specter7885@gmail.com"],
               ["Marin", "marin.b.anderson@gmail.com"],
               ["Chris", "cnelson125@gmail.com"],
               ["Emory", "unknown"]]

    for index, (name, email) in enumerate(singers):

        fill_email(template_file,index+1,name,email)
