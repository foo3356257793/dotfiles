#!/usr/bin/sage

import time

"""
Note: this takes way too long!
"""

if __name__ == "__main__":

    max_n = 10**5

    factors = []

    start_tm = time.perf_counter()

    for p in prime_range(1,max_n):

        GFp = GF(p)

        mring.<u> = GFp[]

        poly_eq = u^2 + 1

        rts = poly_eq.roots()

        if len(rts) <= 0:

            factors.append(p)

        else:

            lat = matrix(ZZ, 2, 2)
            lat[0,0] = p
            lat[1,1] = 1
            lat[1,0] = -ZZ(rts[0][0])

            lat = lat.LLL()

            a = lat[0,0]
            b = lat[0,1]

            if a < 0:
                a *= -1
            if b < 0:
                b *= -1
            if a < b:
                t = a; a = b; b = t

            factors.append(a+b*I)

    end_tm = time.perf_counter()

    tm = end_tm - start_tm

    print("TIME = %.3lf" % tm)
