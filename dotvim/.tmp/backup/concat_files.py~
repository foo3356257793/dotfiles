#!/usr/bin/python3

import os

IGNORE_EXT = set([".eps",".pdf",".png",".svg",".ico",".jpg"])

def ext_ignore(fname):
    _, ext = os.path.splitext(fname)
    return (ext in IGNORE_EXT)

def what_extensions(dirs):

    out = set()

    for dirname in dirs:
        for root, dirs, files in os.walk(dirs[0]):
            for fname in files:
                _, ext = os.path.splitext(fname)
                out.add(ext)

    return out

def concat_files(files,name):

    outfile = f"{name}.txt"

    with open(outfile, "w") as f_out:
        for fname in files:

            if ext_ignore(fname):
                continue

            print(f"processing {fname}")

            f_out.write("\n")
            f_out.write(f"# CONCAT_FILES_HEADER: {fname}\n")
            f_out.write("\n")
            with open(fname,"r") as f_in:
                for line in f_in:
                    f_out.write(line)

def concat_dir(dirname):

    files = []
    for root, dirs, _files in os.walk(dirname):
        files += [os.path.join(root,_) for _ in _files]

    concat_files(files,dirname)

if __name__ == "__main__":

    """
    dirs = ["QQ_mat"]

    for dirname in dirs:
        concat_dir(dirname)

    """

    files = ["QQ_mat.txt", "QQ_mat.hpp", "QQ_mat.cpp", "QQ_vec.hpp",
             "QQ_vec.cpp", "type_exhausts.py"]

    concat_files(files, "QQ_stuff")

