#!/usr/bin/sage

if __name__ == "__main__":

    fp = open('keylog.txt', 'r')

    codes = fp.readlines()

    fp.close()

    codes = [c.strip() for c in codes]

    # first gather all the characters used

    all_char = []

    for c in codes:

        for l in c:

            if not l in all_char:

                all_char.append(l)

    all_char.sort()

    min_len = len(all_char)

    # greedy algorithm

    head = ''
    tail = ''

    go = True

    while go:

        go = False

        print("LOOP")
        print(head, tail)

        for l in all_char:

            if l in head or l in tail:
                continue

            # go through the codes to see which characters are before and after
            before = []
            after = []
            for c in codes:

                if l in c:

                    j = c.index(l)

                    for i in range(j):

                        if not c[i] in before and not c[i] in head:

                            before.append(c[i])

                    for i in range(j+1,3):

                        if not c[i] in after and not c[i] in tail:

                            after.append(c[i])

            before.sort()
            after.sort()

            if len(before) == 0:
                head = head + l
                go = True
            elif len(after) == 0:
                tail = l + tail
                go = True

    print("answer")
    print("%s%s" % (head, tail))




