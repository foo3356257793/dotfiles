# Notes

For example, consider 'UDD'.

Having 'U' means $a_0 = 1 \bmod{3}$.
Having 'D' means $a_1 = 0 \bmod{3}$.
Having 'D' means $a_2 = 0 \bmod{3}$.

We have
$$
a_2 = \frac{a_1}{3} = 0 \bmod{3}
$$
so $a_1 = 0 \bmod{9}$.

Next,
$$
a_1 = \frac{4a_0 + 2}{3} \bmod{3}
$$

We have
$$
9k = \frac{4a_0 + 2}{3}
$$
so
$$
27k = 4a_0 + 2
$$
$$
27k - 2 = 4a_0
$$
So
$$
a_0 = -2/4 \bmod{27} \; .
$$

## In general

Suppose inductively we have $a_i = r \bmod{3^k}$.

1. If
$$
a_i = \frac{4a_{i-1} + 2}{3}
$$
Then
$$
4a_{i-1} + 2 = 3r \bmod{3^{k+1}}
$$
$$
a_{i-1} = \frac{3r-2}{4} \bmod{3^{k+1}}
$$

2. If
$$
a_i = \frac{a_{i-1}}{3}
$$
then
$$
a_{i-1} = 3r \bmod{3^{k+1}}
$$

3. If
$$
a_i = \frac{2a_{i-1}-1}{3}
$$
Then
$$
3r = 2a_{i-1} - 1 \bmod{3^{k+1}}
$$
and
$$
a_{i-1} = \frac{3r+1}{2} \bmod{3^{k+1}}
$$

## Again

Collect the mod values of the $a_i$ and then rewind it.

## Final

Have $x = r \bmod{M}$.
Want $x > B$.

