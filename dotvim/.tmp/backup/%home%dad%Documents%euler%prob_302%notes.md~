*Achilles number*:
of the form

$$
p_1^{e_1} ... p_n^{e_n}
$$

with $e_1,\ldots,e_n > 1$
and $\gcd(e_1,\ldots,e_n) = 1$.

*subproblem*.
Looking for Achilles numbers below $10^{18}$.

*idea*.
Maybe can do something around numbers of
size $(10^{18})^{1/3} = 10^6$.

*idea*.
The worst case is $p_1^2 p_2^3$.
This suggests primes up to $10^9$, which is
not great.

*totient function*.
For

$$
p_1^{e_1} ... p_n^{e_n}
$$

we have

$$
n (1-1/p_1) ... (1-1/p_n)
=
p_1^{e_1-1} ... p_n^{e_n-1} (p_1-1) ... (p_n-1)
$$
The trick is that we need the $p_i-1$ to resolve nicely.

*Pairs*.
Suppose
$p_1^2 p_2^3$
works.  We get
$$
p_1 p_2^2 (p_1-1)(p_2-1)
$$
This gives
$$
2^2 p_1 p_2^2 \frac{p_1-1}{2} \frac{p_2-1}{2}
$$
We need at least another factor of $p_1$ here, so
we need $p_2-1 \equiv 0 \bmod{p_1}$.  This gives
$p_2 = kp_1 + 1$ for some $p_1$.

Note that this latter condition suggests
$$
p_1^2 p_2^3 \geq p_1^5
$$
so that $p_1 \leq 10^{18/5}$.

Next, note that $p_1 - 1 \not\equiv 0 \bmod{p_2}$
since $p_1 < p_2$.

*note*.

If $p$ is the largest prime divisor of one of these numbers,
then $p$ has exponent at least $3$.

_Proof_.

$$
\phi(p_1^{e_1} \cdots p_n^{e_n})
=
p_1^{e_1-1} \cdots p_n^{e_n-1}
(p_1-1) \cdots (p_n-1)
$$
If $p_n$ is the largest, then it is not a divisor
of $p_1-1,\ldots,p_n-1$.  Since $e_n > 1$,
$p_n$ is a divisor of this value.  It needs to have
exponent $e_n-1\geq 2$, which gives the result.

This gives a bound on these primes of size $p \leq (10^{18})^{1/3} = 10^6$.
This is fine.

*result*.
There are about $1000$ choices for largest prime for one of these numbers.

*next*.  Suppose we are looking at numbers of the form $kp^3$.

**Claim**. Need $k$ of the form
$k = cd^2$, where $c | d$.

_Proof_
Prime factors of $k$ have to at least be $2$.

*next.* Given just $d^2 p^3$, we have a strong primary test:
check whether the $q-1$ terms of $\phi(d^2p^3)$ don't introduce
new prime factors with exponent $1$.

*new factors*.
If we pair $p$ with a prime $q$, we can consider the new factors which $q$ introduces.  Either $q$ repeats factors from $p-1$ or it introduces new factors.  For the new factors, we then need to pair $q$.

*example*. If $n_1, n_2$ are strong powerful numbers, then so is $n_1 n_2$.

*try*. Compute strong powerful numbers up to a small bound.

*note*. Let $p_1$ be the largest prime. It has power at least $3$.
Let $p_2$ be the next largest prime.  Either it is a factor of $p-1$,
or it must have a power of at least $3$.

*note*. Gather together a maximal cubic factor $c^3$ of the number.  Let $b^2$ be the maximal coprime factor of this.  Consider $\phi(c)$.  Then, the largest prime factor with multiplicity $1$ of $\phi(c)$ must be the largest prime factor of $b$.  We can then fill out the rest of the number inductively.

_Proof_. Let $n = b^2 c^3 C$, where $C$ is a divisor of $c$.  Then
$$
\phi(n) = \phi(b^2) \phi(c^3C) \; .
$$
Consider the largest prime factor of $b$.  It divides $\phi(b^2)$ with multiplicity one by construction.
It hence is a factor of $\phi(c^3C)$.

*actually*.  Given $c^3$, compute
$$
\prod_{p | c} (p-1)
$$
Consider the largest prime factor of this.

1. If multiplicity is $>1$, we could include an extra factor in $b$ or not.
This is an exhaust.
2. If multiplicity is $1$, we must include a factor in $b$.

_Proof_.
Above shows that the largest prime factor of $b$ must divide $\phi(c^3)$.
By assumption, factors of $b$ are coprime to $c$, so it must divide the above.
Conversely, consider the largest prime factor of this.  It the multiplicity is $1$, it must be accounted for by $b$.

# optimizations

In the branching step, I am doing a lazy thing.
I do a multiply and then refactor the candidate and its euler phi.

# solution

got it down to about 10 minutes
