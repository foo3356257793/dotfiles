QQ_mat translate(const std::function<void(fmpq_mat_t,const fmpq_mat_t,const fmpq_mat_t)> &fun,
    const _QQ_mat_1 &in_1, const _QQ_mat_2 &in_2) {
  auto out = QQ_mat(in_1.nrows(),in_2.ncols());
  fun(out.data,in_1.data,in_2.data);
  return out;
}


QQ_mat operator+(const _QQ_mat_1 &in_1, const _QQ_mat_2 &in_2) {
  if(!in_1.dim_match(in_2)){
    throw std::invalid_argument("Dimensions don't match for +");
  }
  return translate(fmpq_mat_add,in_1,in_2);
}

QQ_mat operator-(const _QQ_mat_1 &in_1, const _QQ_mat_2 &in_2) {
  if(!in_1.dim_match(in_2)){
    throw std::invalid_argument("Dimensions don't match for -");
  }
  return translate(fmpq_mat_sub,in_1,in_2);
}

QQ_mat operator*(const _QQ_mat_1 &in_1, const _QQ_mat_2 &in_2) {
  if(!in_1.dim_rmul_match(in_2)){
    throw std::invalid_argument("Dimensions don't match for *");
  }
  return translate(fmpq_mat_mul,in_1,in_2);
}


