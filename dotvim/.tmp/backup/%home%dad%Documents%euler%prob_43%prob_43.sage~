#!/usr/bin/sage

small_primes = prime_range(17+1)

def branch_pandigital(val, digits):

    """
    Don't abort when we find a hit
    """

    num_digits = len(digits)

    if num_digits == 0:

        return val

    ret = 0

    for i in range(num_digits):

        new_val = 10*val + digits[i]

        prime_test = (7-num_digits)

        if prime_test >= 0:

            test_val = new_val % 1000

            if test_val % small_primes[prime_test] != 0:
                continue

        rest_digits = digits[0:i]
        rest_digits = rest_digits + digits[i+1:]

        ret += branch_pandigital(new_val, rest_digits)

    return ret

if __name__ == "__main__":


    digits = [i for i in range(10)]
    answer = branch_pandigital(0, digits)

    print(answer)
